<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kapilya Management System ðŸ’’</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      /* Background image path may need adjustment on your system */
      background-image: url('c:/Users/LAB_A/Downloads/OIP.jpg'); 
      background-size: cover;
      background-position: center;
      margin: 0;
      padding: 0;
    }

    .container {
      max-width: 850px;
      margin: 40px auto;
      background: rgba(255, 255, 255, 0.9);
      padding: 25px;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
    }

    h1 {
      text-align: center;
      color: #2e4a2d;
      margin-bottom: 10px;
    }

    h2 {
      border-bottom: 2px solid #ccc;
      padding-bottom: 5px;
      color: #333;
      margin-top: 25px;
    }

    form div {
      margin-bottom: 15px;
    }

    label {
      display: block;
      font-weight: bold;
      margin-bottom: 5px;
    }

    input[type="text"], input[type="password"], input[type="tel"], textarea {
      width: 100%;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }

    input[type="radio"] {
      margin-right: 5px;
    }

    input[type="submit"], button, .nav-btn { /* Added .nav-btn */
      background-color: #4CAF50;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 4px;
      cursor: pointer;
      margin-right: 10px; /* Spacing for navigation buttons */
    }

    input[type="submit"]:hover, button:hover, .nav-btn:hover { /* Added .nav-btn */
      background-color: #45a049;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }

    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }

    th {
      background-color: #f2f2f2;
    }

    footer {
      text-align: center;
      color: #333;
      font-size: 14px;
      margin-top: 25px;
    }

    .hidden {
      display: none;
    }

    .logout-btn {
      background-color: #d9534f;
      float: right;
    }

    .logout-btn:hover {
      background-color: #c9302c;
    }

    .link {
      text-align: center;
      margin-top: 10px;
    }

    .link a {
      color: #4CAF50;
      text-decoration: none;
      font-weight: bold;
    }

    .link a:hover {
      text-decoration: underline;
    }

    #successMessage {
      color: green;
      text-align: center;
      display: none;
    }

    /* Added style for the navigation bar on the main pages */
    .nav-bar {
      display: flex;
      justify-content: flex-start;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 1px solid #ccc;
    }
  </style>
</head>

<body>
  <div class="container" id="loginPage">
    <h1>Kapilya Management System ðŸ’’</h1>
    <p style="text-align:center;">Please login to access the system.</p>

    <form id="loginForm">
      <div>
        <label>Username:</label>
        <input type="text" id="username" placeholder="Enter username" required>
      </div>

      <div>
        <label>Password:</label>
        <input type="password" id="password" placeholder="Enter password" required>
      </div>

      <input type="submit" value="Login">
    </form>

    <div class="link">
      <p>Don't have an account? <a href="#" id="goToSignup">Sign Up</a></p>
    </div>
  </div>

  <div class="container hidden" id="signupPage">
    <h1>Create Account ðŸ’’</h1>
    <p style="text-align:center;">Fill up the form below to register.</p>

    <form id="signupForm">
      <div>
        <label>New Username:</label>
        <input type="text" id="newUsername" placeholder="Enter username" required>
      </div>

      <div>
        <label>New Password:</label>
        <input type="password" id="newPassword" placeholder="Enter password" required>
      </div>

      <div>
        <label>Confirm Password:</label>
        <input type="password" id="confirmPassword" placeholder="Confirm password" required>
      </div>

      <input type="submit" value="Sign Up">
    </form>

    <div class="link">
      <p>Already have an account? <a href="#" id="goToLogin">Login</a></p>
    </div>

    <div id="successMessage">Account created successfully! Redirecting...</div>
  </div>

  <div class="container hidden" id="registerMemberPage">
    <h1>Kapilya Management System ðŸ’’</h1>
    <button class="logout-btn" id="logoutBtnTop">Logout</button> <p style="text-align:center;">Register chapel members and manage them easily.</p>

    <div class="nav-bar">
        <button class="nav-btn" id="goToRegister">Register Member</button>
        <button class="nav-btn" id="goToMembersList">View Members</button>
    </div>

    <h2>Register New Member</h2>
    <form id="memberForm">
      <div>
        <label>Full Name:</label>
        <input type="text" id="name" placeholder="Enter full name" required>
      </div>

      <div>
        <label>Address:</label>
        <textarea id="address" placeholder="Enter address" required></textarea>
      </div>

      <div>
        <label>Contact Number:</label>
        <input type="tel" id="contact" placeholder="Enter contact number" required>
      </div>

      <div>
        <label>Gender:</label>
        <input type="radio" name="gender" value="Male" required> Male
        <input type="radio" name="gender" value="Female"> Female
      </div>

      <input type="submit" value="Register Member">
    </form>

    <footer>
      Â© 2025 Kapilya Management System | All Rights Reserved
    </footer>
  </div>

  <div class="container hidden" id="membersListPage">
    <h1>Kapilya Management System ðŸ’’</h1>
    <button class="logout-btn" id="logoutBtnBottom">Logout</button> <p style="text-align:center;">List of all registered chapel members.</p>

    <div class="nav-bar">
        <button class="nav-btn" id="backToRegister">Register Member</button>
        <button class="nav-btn" id="viewMembersList">View Members</button>
    </div>

    <h2>Current Members</h2>
    <table id="memberTable">
      <thead>
        <tr>
          <th>ID</th>
          <th>Full Name</th>
          <th>Address</th>
          <th>Contact</th>
          <th>Gender</th>
          <th>Date Registered</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <footer>
      Â© 2025 Kapilya Management System | All Rights Reserved
    </footer>
  </div>

  <script>
    // PAGE ELEMENTS
    const loginPage = document.getElementById("loginPage");
    const signupPage = document.getElementById("signupPage");
    const registerMemberPage = document.getElementById("registerMemberPage"); // New ID
    const membersListPage = document.getElementById("membersListPage");       // New ID
    const goToSignup = document.getElementById("goToSignup");
    const goToLogin = document.getElementById("goToLogin");
    const successMessage = document.getElementById("successMessage");
    const logoutBtnTop = document.getElementById("logoutBtnTop");
    const logoutBtnBottom = document.getElementById("logoutBtnBottom");
    const goToRegister = document.getElementById("goToRegister");
    const goToMembersList = document.getElementById("goToMembersList");
    const backToRegister = document.getElementById("backToRegister");

    // USERS (STORED LOCALLY)
    let users = JSON.parse(localStorage.getItem("users")) || [
      { username: "admin", password: "1234" }
    ];

    // NAVIGATION FUNCTIONS
    function showPage(pageToShow) {
        loginPage.classList.add("hidden");
        signupPage.classList.add("hidden");
        registerMemberPage.classList.add("hidden");
        membersListPage.classList.add("hidden");

        pageToShow.classList.remove("hidden");
    }

    // SWITCH TO SIGNUP PAGE
    goToSignup.addEventListener("click", () => {
      showPage(signupPage);
    });

    // SWITCH TO LOGIN PAGE
    goToLogin.addEventListener("click", () => {
      showPage(loginPage);
    });

    // SWITCH TO MEMBERS LIST PAGE
    goToMembersList.addEventListener("click", () => {
        showPage(membersListPage);
    });

    // SWITCH BACK TO REGISTER MEMBER PAGE
    goToRegister.addEventListener("click", () => {
        showPage(registerMemberPage);
    });
    backToRegister.addEventListener("click", () => {
        showPage(registerMemberPage);
    });

    // SIGNUP FUNCTION
    document.getElementById("signupForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const newUsername = document.getElementById("newUsername").value;
      const newPassword = document.getElementById("newPassword").value;
      const confirmPassword = document.getElementById("confirmPassword").value;

      if (newPassword !== confirmPassword) {
        alert("Passwords do not match!");
        return;
      }

      const userExists = users.some(u => u.username === newUsername);
      if (userExists) {
        alert("Username already exists!");
        return;
      }

      users.push({ username: newUsername, password: newPassword });
      localStorage.setItem("users", JSON.stringify(users));

      successMessage.style.display = "block";
      setTimeout(() => {
        successMessage.style.display = "none";
        showPage(loginPage);
      }, 2000);
    });

    // LOGIN FUNCTION
    document.getElementById("loginForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const username = document.getElementById("username").value;
      const password = document.getElementById("password").value;

      const user = users.find(u => u.username === username && u.password === password);

      if (user) {
        showPage(registerMemberPage); // Show the main member registration page after login
      } else {
        alert("Invalid username or password!");
      }
    });

    // LOGOUT FUNCTION (for both logout buttons)
    function logout() {
        showPage(loginPage);
    }
    logoutBtnTop.addEventListener("click", logout);
    logoutBtnBottom.addEventListener("click", logout);

    // MEMBER REGISTRATION
    const memberForm = document.getElementById("memberForm");
    const memberTableBody = document.getElementById("memberTable").querySelector("tbody");
    let memberId = 1; // Simple ID counter

    // Load members from local storage if any exist (optional persistence)
    let members = JSON.parse(localStorage.getItem("members")) || [];
    if (members.length > 0) {
        memberId = members[members.length - 1].id + 1;
        renderMembers();
    }
    
    // Function to render the table content
    function renderMembers() {
        memberTableBody.innerHTML = ''; // Clear existing rows
        members.forEach(member => {
            const row = `<tr>
                <td>${member.id}</td>
                <td>${member.name}</td>
                <td>${member.address}</td>
                <td>${member.contact}</td>
                <td>${member.gender}</td>
                <td>${member.date}</td>
            </tr>`;
            memberTableBody.insertAdjacentHTML("beforeend", row);
        });
    }


    memberForm.addEventListener("submit", function(e) {
      e.preventDefault();

      const name = document.getElementById("name").value;
      const address = document.getElementById("address").value;
      const contact = document.getElementById("contact").value;
      const gender = document.querySelector('input[name="gender"]:checked').value;

      const date = new Date().toLocaleDateString();

      const newMember = {
          id: memberId++,
          name,
          address,
          contact,
          gender,
          date
      };

      members.push(newMember);
      localStorage.setItem("members", JSON.stringify(members)); // Save to local storage
      renderMembers(); // Update the table
      
      alert("Member successfully registered!"); // Confirmation
      memberForm.reset();
    });
    
    // Initial render when the page loads (or after login, if you prefer)
    // We can call it here so the data is ready when the user navigates to the list.
    renderMembers(); 
  </script>
</body>
</html>